@use "sass:color";

@import "~bootstrap-colorpicker/dist/css/bootstrap-colorpicker.css";
@import "~leaflet-draw/dist/leaflet.draw.css";
@import "~leaflet/dist/leaflet.css";
@import "~air-datepicker/air-datepicker.css";
@import "~jquery-ui/dist/themes/base/jquery-ui.min.css";
@import "~leaflet.markercluster/dist/MarkerCluster.css";
@import "~leaflet.markercluster/dist/MarkerCluster.Default.css";

.edit-mode {
    a#atlwdg-trigger {
        display: none;
    }

    footer {
        display: none;
    }

    .metadata,
    #search {
        display: flex;
        flex-direction: column;
        min-height: calc(100vh - var(--header-height));

        .container-fluid {
            width: 100%;
        }
    }

    #air-datepicker-global-container {
        .air-datepicker-overlay.-active- {
            z-index: 1005;
        }

        .air-datepicker {
            z-index: 1006;
        }
    }
}


#editorNav li {
    cursor: pointer;
}

#editorAjax {
    display: none;

    &.visible {
        display: inline;
    }
}

.editor {
    --_requiredIndicator: rgb(207, 104, 7);
    display: flex;
    flex-direction: column;
    min-height: 100dvh;

    .editor-menu {
        position: sticky;
        top: var(--header-height);
        background-color: #eee;
        z-index: 1000;
        padding: 0;

        >div {
            padding-inline: 1em;

            span.active {
                font-weight: 600;
            }

            span:not(.active) {
                display: none;
            }

            display: flex;
            flex-direction: row;
            gap: 0 1em;
            justify-content: space-between;

            .editor-nav {
                align-content: center;
            }

            .editor-buttons {
                display: flex;
                flex-direction: row;
                justify-content: center;
                gap: 0.25em;
                padding-block: 1em;
            }
        }
    }

    .editor-body {
        padding: 1em;


        .editor-input {
            @extend .form-control;
            @extend .form-control-sm;
            color: #000;
        }

        .editor-textarea {
            @extend .form-control;
            @extend .form-control-sm;
            height: auto;
            color: #000;
        }

        .editor-remove {
            display: grid;
            grid-template-columns: auto 50px;
            gap: 0.6em;

            >div {
                margin: 0 !important;
                padding: 0.2em 0.6em;
            }
        }

        .ui-sortable {
            .row {
                .provenance {
                    border-bottom: 1px solid #eee;
                    margin-block-end: 0.25em;
                    padding: 0.5em 0;
                }

                &:last-child {
                    .provenance {
                        border-bottom: none;
                        padding-bottom: 0;
                    }
                }
            }
        }

        .editor-button {
            @extend .btn;
            @extend .btn-light;
            @extend .btn-sm;
            @extend .float-end;
        }

        .editor-button-xs {
            @extend .btn;
            @extend .btn-light;
            @extend .btn-sm;
            @extend .float-end;
        }

        .editor-button-remove {
            @extend .btn;
            @extend .btn-light;
            @extend .btn-sm;
        }

        .editor-help {
            @extend .form-text;
            @extend .d-print-none;
            @extend .collapse;
            font-size: 12px;
            line-height: 1.5;
        }

        .component {
            border-bottom: 1px solid color.adjust($gray-light, $lightness: 25%, $space: hsl);
            padding-bottom: 1.25em;
            @extend .mb-3;
            display: none;

            &.visible {
                display: block;
            }

            &.eidconly {
                visibility: hidden;
                height: 0;
            }

            &--textonly {
                border-bottom: none !important;
                margin-block-end: 0 !important;
                padding-bottom: 0 !important;
            }

            .component {
                border-style: solid;
                border-width: 1px;
                border-color: color.adjust($gray-light, $lightness: 15%, $space: hsl);
                border-radius: 5px;
                padding: 0.5em;
                margin-block-end: 1.25em;
            }

            .row {
                $spacer: 3px;
                margin-block-end: $spacer;

                label {
                    padding-top: $spacer;

                    small {
                        font-weight: normal;
                        color: gray;

                        &:before {
                            content: "\A";
                            white-space: pre-wrap;
                        }
                    }
                }
            }

            .dataentry {
                legend {
                    font-size: 18px;
                    font-weight: bold;
                    margin-block-end: 0;
                }

                label {
                    font-size: 12px;

                    a {
                        margin-inline-start: 0.5em;

                        &:hover {
                            text-decoration: none;
                        }
                    }
                }

                &.child {
                    z-index: 0;

                    hr {
                        border-color: #ddd;
                        margin: 0.6em 0;
                    }
                }
            }

            .btnSchemaDetail {
                @extend .btn;
                @extend .btn-light;
                @extend .btn-sm;
                text-align: right;

                span:before {
                    content: "hide ";
                }
            }

            .btnSchemaDetail.collapsed {
                span:before {
                    content: "show " !important;
                }
            }
        }

        .requiredInfo {
            color: var(--_requiredIndicator);
            font-weight: 600;
        }

        .required:not(:has(.child)) {
            label {
                color: var(--_requiredIndicator);

                &:before {
                    content: "*"
                }
            }

            input,
            textarea {
                border-bottom: 2px var(--_requiredIndicator) solid !important;
            }
        }

        .multiline .existing>.row {
            border-style: solid;
            border-width: 1px;
            border-color: color.adjust($gray-light, $lightness: 15%, $space: hsl);
            border-radius: 5px;
            padding: 4px;
        }

        .dropdown {
            @extend .float-end;
            display: inline-block;
        }

        .option-ukeof,
        .option-eidc,
        .option-ukceh,
        .option-inms,
        .option-elter,
        .option-assist,
        .option-nm,
        .option-inms {
            display: none
        }

        .keyword-add {
            display: inline-block;
            @extend .float-start;
        }

        .keywords {
            .uri:disabled {
                font-style: italic;
            }
        }

        // VOCAB KEYWORD PICKER STYLES
        .vocabularyPicker {
            display: flex;
            gap: 0.25em 1.25em;
            flex-wrap: wrap;

            .vocab {
                label {
                    span {
                        font-weight: normal;
                    }
                }
            }
        }

        .dataentry.child:has(.keywordPicker):not(:has(.hidden)) {
            padding-bottom: 1.2em;
            padding-top: 1.2em;
        }

        input.autocomplete::placeholder {
            font-weight: bold;
            font-style: italic;
            opacity: 0.5;
            color: blue;
        }

        .dropdown-menu.predefined {
            margin-block-end: 70px;
            max-height: 350px;
            overflow: auto;
            position: relative;
        }

        .validation {
            display: none;
        }

        .readonly {
            font-size: 90%;
            color: #aaa;
            line-height: 2.5em;
        }

        .ui-sortable,
        .ui-sortable-handle {
            cursor: move;
        }

        .catalogueSearch {
            margin-block-end: 1em;

            input {
                font-size: 0.9em;
            }
        }

        // Hide the leaflet 'save' button as it is never used: https://stackoverflow.com/questions/51360283/how-to-remove-save-option-from-leaflet-draw-api-delete-button
        .leaflet-draw-actions li:first-child a[title="Save changes"] {
            visibility: hidden;
            width: 0;
            padding: 0;
        }
    }
}

@media only screen and (min-width: 600px) {
    .editor {
        flex-direction: row;

        .editor-menu {
            min-height: 0;
            flex: 0 0 250px;

            >div {
                position: sticky;
                top: var(--header-height);
                min-height: calc(100dvh - var(--header-height));
                flex-direction: column;
                gap: 1em 0;
                padding-inline: 0;

                .editor-nav {

                    span {
                        display: block;
                        padding: 0.5em 2em 0.5em 0.5em;
                        text-align: right;

                        &:hover {
                            background-color: lightgray;
                        }
                    }

                    .active {
                        background-color: white;
                        padding: 1em 0.5em;

                        &::after {
                            content: " >";
                        }
                    }
                }

                .editor-buttons {
                    flex-wrap: wrap;
                    gap: 0.5em 1em;
                }
            }
        }
    }
}

.form-control {

    &[readonly],
    &[disabled] {
        background-color: color.adjust($gray-light, $lightness: 30%, $space: hsl);
        color: $gray;
    }
}

#editorValidationMessage {
    .modal-body {
        color: #f00;
        font-weight: bold;
    }
}

ul.ui-autocomplete {
    li.ui-menu-item {
        font-size: 0.8em;
        font-family: var(--font-family-sans-serif), serif;
    }
}

.ui-autocomplete {
    max-height: 350px;
    overflow-y: auto;
    overflow-x: hidden;
    scrollbar-gutter: stable;
    scrollbar-width: thin;


    &::-webkit-scrollbar {
        width: 8px;
    }

    &::-webkit-scrollbar-track {
        background: #f1f1f1;
    }

    &::-webkit-scrollbar-thumb {
        background: #999;
    }
}
